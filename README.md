# FRONT---DeepSmile-Website---Next.js

## Table of contents
* [General information](#general-information)
* [Technologies](#technologies)
* [Setup](#setup)
* [Run project](#run-project)
* [CI/CD](#ci/cd)

## General information
This repository features DeepSmile website

	
## Technologies
This project is created with:
* Next.js
* React
* Typescript
* Apollo
* ChakraUI
* git-secret
* Sentry
* env-cmd
* next-translate

## Setup

### git-secret:
1. Install git-secret:
```
$ brew install git-secret
```

Linux: https://git-secret.io/installation

2. Generate a gpg-key
```
$ gpg --gen-key
```

3. Export your public key
```
$ gpg --export -a my@email.com > public_key.gpg
```

4. Send your public key to someone who has already access

(If you are that someone and wish to add a user to the repository)
```
$ gpg --import public_key.gpg
$ git secret tell user@email.com
```

5. Decrypt files:
```
$ git secret reveal
```

6. Encrypt files: (if you modified .env-cmdrc.json or added new users)
```
$ git secret hide
```

### Sentry:

Your .env-cmdrc.json must contain the following values for both env (prod and preprod) :

```
# sentry dns
"NEXT_PUBLIC_SENTRY_DSN": ""

# organization name
"SENTRY_ORG": ""

# project name
"SENTRY_PROJECT": ""

# https://sentry.io/settings/account/api/auth-tokens/
"SENTRY_AUTH_TOKEN": ""
```

### next-translate:

next-translate builds the next.js pages directory including translations in those pages . That is why we need to develop our app in a pages_ directory. The pages directory shall not be pushed to the repository since it will be generated by CI.

## Run project:
To run this project, install it locally using npm:

### Install dependencies:
```
$ npm install
```

### Run in dev mode:
```
$ npm run dev
```

### Build and start:

Preprod:
```
$ npm run build
```

Prod:
```
$ npm run build:prod
```

Then:
```
$ npm start
```

### Tests:

```
$ npm run test
```

## CI/CD

Please find below a diagram describing our CI/CD strategy

![CI/CD diagram](https://i.imgur.com/rScKlbf.png)



